# ============================================================================
# MemberJunction Environment Configuration Template
# ============================================================================
#
# This file is a TEMPLATE. To set up your local development environment:
#
# 1. Copy this file to create your environment file:
#    cp .env.example .env.local
#
# 2. Update the placeholder values with your actual credentials
#
# 3. (Optional) Encrypt for team sharing:
#    npx dotenvx encrypt -f .env.local
#
# 4. Add the environment script to package.json (if not using .env.local):
#    "env:myenv": "dotenvx run -f .env.myenv --"
#
# ============================================================================
# NAMING CONVENTION
# ============================================================================
#
# Name your .env file to match your MJ Central environment:
#
#   MJ Central Env Name    →    Local File
#   ─────────────────────────────────────────
#   dev                    →    .env.dev
#   staging                →    .env.staging
#   production             →    .env.production
#   preview                →    .env.preview
#   live                   →    .env.live
#   prod-east              →    .env.prod-east
#
# Or use .env.local for a single local development environment.
#
# ============================================================================


# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Get these values from MJ Central after your environment is provisioned,
# or from your database administrator.

# SQL Server hostname (Azure SQL or local)
DB_HOST=your-server.database.windows.net

# SQL Server port (default: 1433)
DB_PORT=1433

# Database name
DB_DATABASE=your-database-name

# Runtime database user (for API connections)
# This user needs db_datareader and db_datawriter roles
DB_USERNAME=MJ_Connect
DB_PASSWORD=your-password-here

# CodeGen database user (for schema modifications)
# This user needs db_owner or elevated permissions
CODEGEN_DB_USERNAME=MJ_CodeGen
CODEGEN_DB_PASSWORD=your-codegen-password-here

# Trust server certificate (required for Azure SQL)
DB_TRUST_SERVER_CERTIFICATE=Y


# ============================================================================
# MEMBERJUNCTION CONFIGURATION
# ============================================================================

# MJ Core schema name (usually __mj)
MJ_CORE_SCHEMA=__mj

# API Key for MJ API authentication (generate a unique key)
# You can generate one with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
MJ_API_KEY=generate-a-unique-api-key

# Enable GraphQL introspection (set to false in production)
ENABLE_INTROSPECTION=true


# ============================================================================
# GRAPHQL API CONFIGURATION
# ============================================================================

# Port for local GraphQL API server
GRAPHQL_PORT=4000

# Base URL for GraphQL API (used for local development)
GRAPHQL_BASE_URL=http://localhost


# ============================================================================
# AUTHENTICATION CONFIGURATION
# ============================================================================
# Choose ONE authentication provider and configure its variables.
# The API automatically detects which provider to use based on which
# variables are set.

# ------------------------------
# Option 1: Azure AD / Entra ID
# ------------------------------
# Get these from Azure Portal > App Registrations > Your App
TENANT_ID=your-azure-tenant-id
WEB_CLIENT_ID=your-azure-client-id

# ------------------------------
# Option 2: Auth0
# ------------------------------
# Get these from Auth0 Dashboard > Applications > Your App
# AUTH0_DOMAIN=your-tenant.auth0.com
# AUTH0_CLIENT_ID=your-auth0-client-id
# AUTH0_CLIENT_SECRET=your-auth0-client-secret

# ------------------------------
# Option 3: Okta
# ------------------------------
# Get these from Okta Admin Console > Applications > Your App
# OKTA_DOMAIN=your-domain.okta.com
# OKTA_CLIENT_ID=your-okta-client-id
# OKTA_CLIENT_SECRET=your-okta-client-secret


# ============================================================================
# RUNTIME CONFIGURATION
# ============================================================================

# Node environment (development, staging, production)
NODE_ENV=development

# Application environment identifier (for logging/debugging)
APP_ENV=local


# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================
#
# STEP 1: Create your environment file
# ─────────────────────────────────────
#   cp .env.example .env.local
#
#
# STEP 2: Get credentials from MJ Central
# ───────────────────────────────────────
#   After MJ Central provisions your environment, get credentials from:
#   - MJ Central dashboard
#   - Your team administrator
#   - Team password manager
#
#
# STEP 3: Update placeholder values
# ──────────────────────────────────
#   Edit .env.local and replace all placeholder values with real credentials
#
#
# STEP 4: (Optional) Encrypt for team sharing
# ───────────────────────────────────────────
#   npx dotenvx encrypt -f .env.local
#
#   This will:
#   - Encrypt the file in place
#   - Generate a private key in .env.keys
#   - Display the key: DOTENV_PRIVATE_KEY_LOCAL="..."
#
#   Save the private key securely (password manager, NOT git)
#   Share with teammates via secure channel
#
#
# STEP 5: Set the decryption key
# ──────────────────────────────
#   export DOTENV_PRIVATE_KEY_LOCAL="your-key-here"
#   echo 'export DOTENV_PRIVATE_KEY_LOCAL="..."' >> ~/.zshrc
#
#
# STEP 6: Run commands with environment loaded
# ────────────────────────────────────────────
#   npm run start:api        # Uses .env.local by default
#   npm run codegen          # Uses .env.local by default
#   npm run migrate          # Uses .env.local by default
#
#
# MULTIPLE ENVIRONMENTS
# ─────────────────────
# To work with multiple environments locally:
#
# 1. Create additional .env files:
#    cp .env.example .env.staging
#    cp .env.example .env.production
#
# 2. Add scripts to package.json:
#    "env:staging": "dotenvx run -f .env.staging --",
#    "env:production": "dotenvx run -f .env.production --",
#    "start:api:staging": "npm run env:staging -- npm run start --workspace=apps/MJAPI",
#    "codegen:staging": "npm run env:staging -- mj codegen"
#
# 3. Run with specific environment:
#    npm run start:api:staging
#    npm run migrate:staging
#    npm run codegen:staging
#
# ============================================================================